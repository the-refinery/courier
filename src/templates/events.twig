{#
/**
 * Blueprints index template
 *
 * @link      	http://therefinery.co.nz
 * @copyright 	Copyright (c) 2017 The Refinery
 * @license 	https://github.com/therefinerynz/courier/blob/master/LICENSE.txt
 * @author 		The Refinery
 * @package 	Courier
 * @since 		1.0.0
 */
#}
{% extends "courier/_layout" %}

{% set tabs = {
	blueprints: { label: 'Blueprints'|t, url: url('courier') },
	deliveries: { label: 'Deliveries'|t, url: url('courier/deliveries') },
	events:     { label: 'Events'|t, url: url('courier/events') }
} %}

{% set selectedTab = 'events' %}
{# {% set fullPageForm = true %} #}

{% import "_includes/forms" as forms %}

{% block actionButton %}
  {# <input type="hidden" name="action" value="heh/hah/save">
  <button class="btn submit">{{ 'Save'|t }}</button> #}
	<div class="buttons">
		<a class="btn submit add icon"
			href="{{ url('courier/events/new') }}">{{ "New Event"|t }}</a>
	</div>

{% endblock %}

{% block content %}
	<h2>{{ 'Events'|t }}</h2>

	{% if events|length %}
			<table class="data" id="events" style="width: 75%">
				<thead>
					<tr>
						<th>{{ 'Event Class'|t }}</th>
						<th>{{ 'Event Handle'|t }}</th>
						<th>{{ 'Description'|t }}</th>
						<th>{{ 'Enabled?'|t }}</th>
						<th></th>
					</tr>
				</thead>
				<tbody>
					{% for event in events %}
						<tr data-id="{{ event.id }}" data-event-class="{{ event.eventClass }}" data-event-handle="{{ event.eventHandle }}">
							<td data-title="Event Class">
								<a href="{{ url('courier/events/' ~ event.id) }}">{{ event.eventClass }}</a>
							</td>
							<td data-title="Event Handle">
								<a href="{{ url('courier/events/' ~ event.id) }}">{{ event.eventHandle }}</a>
							</td>
							<td data-title="Event Description">{{ event.description }}</td>
							<td data-title="Event Enabled">{{ event.enabled ? 'Yes' : 'No' }}</td>
							<td class="thin"><a class="delete icon" title="Delete" role="button"></a></td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
	{% endif %}
{% endblock %}

{% includejs %}
	{# $('.error-button').on('click', function(e) {
		var errorModal = new Garnish.Modal($(
			'<div class="modal courier-modal"><div class="courier-modal__wrapper"><h2 class="courier-modal__header">Error:</h2><p>' +
			$(this).siblings('.error').html() +
			'</p></div></div>'
		));
	}); #}
	var adminTable = new Craft.AdminTable({
		tableSelector: '#events',
		noObjectsSelector: '#no-events',
		deleteAction: 'courier/events/delete',
		onDeleteItem: function() {
			{# if (adminTable.totalItems == 0) {
				$('#has-deliveries').remove();
				$('#no-deliveries').show().removeClass('hidden');
			} #}
		}
	});
{% endincludejs %}